"""
    Hunting C2/Adversaries Infrastructure
"""

import csv
import shodan
from censys.search import CensysHosts
from censys.search import SearchClient
from censys.search import CensysCertificates
from APIKEY import APIKEY_SHODAN2

# Dictionary for th total result
result_dict = dict()

# Shodan search
shodan_api_key = APIKEY_SHODAN2
shodan_query_list = [
    ["Cobalt Strike C2", "product:'Cobalt+Strike+Beacon'"],
    ["Metasploit/MSF", "ssl:'MetasploitSelfSignedCA'"],
    ["Covenant C2", "ssl:'Covenant' http.component:'Blazor'"],
    ["Mythic C2", "ssl:Mythic+port:7443"],
    ["Brute Ratel C4", "http.html_hash:-1957161625"],
    ["Deimos C2", "http.html_hash:-14029177"],
    ["Posh C2", "ssl:'P18055077'"],
    ["Sliver C2", "ssl.jarm:3fd21b20d00000021c43d21b21b43d41226dd5dfc615dd4a96265559485910+'HTTP/1.1+404+Not+Found'+'Cache-Control:+no-store,+no-cache,+must-revalidate'+'Content-Length:+0'"],
    ["C3 from WithSecure", "HTTP/1.1+200+OK+Connection:+close+Content-Length:+712+Accept-Ranges:+bytes+Content-Type:+text/html+Server:+Kestrel"]
]
shodan_ip_list = [
    ['142.151.158.52', '142.150.158.60', '142.150.158.115', '142.1.66.66', '142.151.158.209', '142.150.158.38',
     '142.1.66.101', '142.1.66.95', '142.1.66.203', '142.150.158.102', '221.219.133.15', '142.1.66.32', '52.87.167.136',
     '142.151.158.188', '142.151.158.33', '142.151.158.15', '142.150.158.39', '138.51.24.29', '142.151.158.179',
     '54.225.130.15', '142.1.66.64', '138.51.24.24', '142.1.66.155', '14.132.154.99', '138.51.24.61', '142.1.66.208',
     '142.150.158.17', '142.150.158.173', '142.1.66.200', '142.1.66.192', '96.61.186.173', '119.136.196.24',
     '142.151.158.11', '142.151.158.90', '138.51.24.248', '138.51.24.99', '140.210.21.15', '142.151.158.131',
     '142.1.66.188', '142.150.158.29', '142.150.158.188', '138.51.24.206', '138.51.24.158', '138.51.24.79',
     '142.1.66.35', '142.151.158.16', '3.106.74.163', '96.84.38.54', '138.51.24.208', '138.51.24.170', '138.51.24.198',
     '142.1.66.6', '142.150.158.144', '138.51.24.61', '142.151.158.27', '138.51.24.30', '142.150.158.71',
     '142.151.158.22', '142.151.158.216', '142.1.66.250', '138.51.24.175', '142.1.66.101', '142.150.158.92',
     '142.1.66.157', '142.150.158.181', '142.151.158.218', '142.1.66.247', '142.150.158.100', '142.151.158.19',
     '138.51.24.30', '138.51.24.100', '172.114.238.152', '142.151.158.91', '142.150.158.16', '142.151.158.47',
     '142.1.66.66', '142.150.158.59', '138.51.24.209', '183.180.13.9', '84.10.128.9', '138.51.24.148', '142.1.66.211',
     '142.151.158.93', '142.150.158.181', '142.1.66.36', '142.151.158.181', '119.23.32.129', '14.211.43.122',
     '142.1.66.238', '142.151.158.143', '138.51.24.121', '138.51.24.58', '142.151.158.148', '142.1.66.195',
     '142.1.66.192', '142.150.158.183', '142.150.158.202', '142.150.158.109', '142.150.158.97', '142.150.158.63'],

    ['27.148.142.215', '111.161.116.156', '45.116.81.71', '220.194.103.67', '45.116.80.187', '42.202.32.179',
     '111.174.13.131', '123.184.61.14', '138.113.205.34', '138.113.137.215', '157.185.170.144', '119.84.87.59',
     '138.113.192.45', '163.171.109.60', '112.48.167.18', '138.113.36.51', '183.165.28.77', '138.113.154.114',
     '167.179.254.103', '138.113.215.125', '157.185.164.56', '175.21.255.71', '14.136.137.62', '91.106.109.12',
     '210.61.181.20', '138.113.135.188', '61.161.2.26', '106.225.223.189', '111.161.123.2', '103.211.150.26',
     '124.134.127.229', '36.103.247.250', '120.240.99.120', '157.185.149.73', '138.113.240.17', '138.113.150.28',
     '138.113.138.199', '36.170.30.56', '150.138.105.78', '183.220.149.145', '116.162.187.45', '113.194.59.117',
     '138.113.137.160', '118.107.170.148', '163.171.199.45', '116.162.189.31', '163.171.141.120', '113.194.59.203',
     '45.116.82.100', '163.171.130.190', '138.113.211.219', '163.171.160.240', '113.194.61.186', '139.215.251.183',
     '117.91.185.98', '27.148.146.45', '117.68.152.211', '120.226.15.169', '138.113.19.179', '138.113.53.43',
     '106.60.71.207', '163.171.216.81', '163.171.109.52', '43.243.234.20', '163.171.198.184', '117.27.241.247',
     '138.113.129.69', '163.171.146.209', '58.220.70.55', '110.242.22.36', '157.185.169.76', '110.52.57.29',
     '138.113.102.114', '220.194.103.21', '45.124.126.27', '138.113.41.245', '45.116.82.245', '138.113.144.204',
     '138.113.107.99', '124.236.25.216', '138.113.35.34', '117.145.179.75', '163.171.198.150', '183.201.234.90',
     '110.242.22.33', '27.151.10.95', '111.124.72.153', '220.194.103.199', '138.113.57.75', '27.155.108.35',
     '163.171.134.92', '138.113.60.195', '174.35.2.11', '61.163.248.13', '14.225.240.47', '58.220.74.28',
     '61.132.231.211', '138.113.115.20', '138.113.50.73', '138.113.210.86'],

    ['142.150.158.60', '142.150.158.103', '142.150.158.115', '142.151.158.73', '142.1.66.95', '142.1.66.203',
     '142.150.158.102', '221.219.133.15', '142.1.66.32', '142.151.158.188', '142.151.158.33', '142.151.158.15',
     '142.150.158.39', '138.51.24.29', '142.151.158.179', '142.1.66.64', '138.51.24.24', '142.1.66.155', '138.51.24.61',
     '142.1.66.208', '142.150.158.17', '142.150.158.173', '142.1.66.200', '142.1.66.192', '96.61.186.173',
     '119.136.196.24', '142.151.158.11', '142.151.158.90', '138.51.24.248', '138.51.24.99', '142.151.158.131',
     '142.1.66.188', '142.150.158.29', '138.51.24.175', '142.150.158.188', '138.51.24.206', '138.51.24.158',
     '142.150.158.26', '138.51.24.79', '142.1.66.35', '142.151.158.16', '96.84.38.54', '142.150.158.58',
     '138.51.24.170', '138.51.24.198', '142.1.66.6', '142.150.158.144', '138.51.24.61', '142.151.158.27',
     '138.51.24.30', '142.150.158.71', '142.151.158.22', '142.151.158.216', '142.1.66.250', '138.51.24.175',
     '142.1.66.101', '142.150.158.92', '142.1.66.157', '142.151.158.218', '142.1.66.247', '138.51.24.136',
     '142.151.158.80', '142.151.158.19', '138.51.24.30', '138.51.24.100', '172.114.238.152', '142.151.158.91',
     '142.151.158.47', '142.1.66.66', '142.151.158.147', '138.51.24.209', '183.180.13.9', '84.10.128.9',
     '138.51.24.148', '142.1.66.211', '142.150.158.181', '142.1.66.36', '142.151.158.246', '142.151.158.181',
     '119.23.32.129', '142.1.66.238', '142.151.158.143', '138.51.24.121', '138.51.24.58', '142.151.158.148',
     '142.1.66.195', '142.1.66.192', '142.150.158.183', '142.150.158.202', '142.150.158.109', '142.150.158.97',
     '152.89.162.229', '142.151.158.218', '142.151.158.7', '138.51.24.180', '138.51.24.139', '142.1.66.146',
     '142.1.66.154', '138.51.24.223', '142.1.66.12'],

    ['142.151.158.52', '142.150.158.60', '142.1.66.66', '142.151.158.209', '142.150.158.38', '123.56.64.105',
     '142.1.66.95', '142.1.66.203', '221.219.133.15', '142.1.66.32', '142.151.158.188', '142.150.158.39',
     '142.151.158.179', '142.1.66.64', '138.51.24.24', '142.1.66.155', '14.132.154.99', '138.51.24.61', '142.1.66.208',
     '142.150.158.17', '142.150.158.173', '142.1.66.200', '142.1.66.192', '119.136.196.24', '142.151.158.11',
     '142.151.158.90', '138.51.24.99', '142.151.158.131', '142.1.66.188', '142.150.158.29', '138.51.24.175',
     '142.150.158.188', '138.51.24.206', '138.51.24.158', '138.51.24.134', '142.1.66.112', '142.151.158.16',
     '96.84.38.54', '138.51.24.208', '138.51.24.69', '138.51.24.170', '138.51.24.198', '142.150.158.144',
     '138.51.24.61', '142.151.158.27', '138.51.24.30', '142.150.158.71', '142.151.158.22', '142.151.158.216',
     '142.1.66.250', '138.51.24.175', '142.1.66.101', '142.150.158.181', '142.151.158.218', '138.51.24.136',
     '142.151.158.80', '138.51.24.30', '142.151.158.91', '142.150.158.16', '142.151.158.47', '142.1.66.66',
     '138.51.24.209', '183.180.13.9', '84.10.128.9', '142.1.66.49', '142.150.158.181', '142.1.66.36', '119.23.32.129',
     '14.211.43.122', '142.151.158.143', '138.51.24.121', '138.51.24.58', '142.151.158.148', '142.1.66.195',
     '142.1.66.192', '66.244.67.56', '142.150.158.183', '142.150.158.202', '142.150.158.97', '142.151.158.218',
     '142.1.66.102', '142.151.158.7', '138.51.24.180', '138.51.24.139', '142.1.66.146', '138.51.24.223',
     '142.150.158.161', '35.229.111.244', '142.150.158.150', '142.151.158.40', '142.1.66.31', '138.51.24.42',
     '142.150.158.182', '142.150.158.159', '142.150.158.201', '138.51.24.241', '138.51.24.125', '142.151.158.132',
     '142.1.66.37', '138.51.24.183'],

    ['142.150.158.60', '142.150.158.103', '142.1.66.66', '142.150.158.103', '142.151.158.209', '142.151.158.73',
     '142.150.158.38', '123.56.64.105', '142.1.66.95', '142.1.66.203', '221.219.133.15', '142.151.158.188',
     '142.150.158.39', '142.151.158.179', '142.1.66.64', '120.78.194.87', '170.187.151.51', '142.1.66.155',
     '14.132.154.99', '138.51.24.61', '142.1.66.208', '142.150.158.17', '142.150.158.173', '142.1.66.200',
     '142.1.66.192', '142.151.158.11', '142.151.158.90', '138.51.24.99', '142.151.158.114', '142.151.158.131',
     '142.150.158.29', '142.150.158.188', '138.51.24.206', '138.51.24.158', '142.151.158.16', '96.84.38.54',
     '65.1.254.154', '138.51.24.208', '138.51.24.170', '138.51.24.198', '138.51.24.61', '142.151.158.27',
     '138.51.24.30', '142.150.158.71', '142.151.158.22', '142.151.158.216', '142.1.66.250', '138.51.24.175',
     '142.1.66.101', '142.1.66.157', '142.150.158.181', '138.51.24.30', '138.51.24.100', '142.1.66.66', '183.180.13.9',
     '84.10.128.9', '138.51.24.148', '142.150.158.4', '142.1.66.49', '142.150.158.181', '142.1.66.36',
     '142.151.158.246', '119.23.32.129', '142.1.66.238', '142.151.158.143', '138.51.24.121', '138.51.24.58',
     '142.151.158.148', '142.1.66.195', '142.1.66.192', '142.150.158.183', '142.150.158.202', '142.150.158.109',
     '142.150.158.97', '142.151.158.218', '142.151.158.7', '138.51.24.180', '138.51.24.139', '142.1.66.146',
     '138.51.24.223', '13.251.171.28', '142.150.158.161', '35.229.111.244', '142.150.158.150', '103.81.56.46',
     '142.1.66.31', '138.51.24.42', '142.150.158.201', '138.51.24.241', '138.51.24.125', '142.1.66.37', '138.51.24.183',
     '142.1.66.147', '18.208.137.112', '142.151.158.50', '142.150.158.119', '142.1.66.137', '142.150.158.108',
     '142.151.158.86', '142.150.158.220'],

    ['142.150.158.60', '142.150.158.55', '142.150.158.103', '142.150.158.38', '142.1.66.95', '142.1.66.203',
     '221.219.133.15', '142.151.158.188', '142.150.158.39', '142.151.158.179', '142.1.66.64', '120.78.194.87',
     '138.51.24.24', '170.187.151.51', '142.1.66.155', '14.132.154.99', '138.51.24.61', '142.1.66.208',
     '142.150.158.17', '142.150.158.173', '142.1.66.200', '142.1.66.192', '142.151.158.11', '142.151.158.90',
     '138.51.24.99', '142.151.158.114', '142.151.158.131', '142.150.158.29', '138.51.24.175', '142.150.158.188',
     '138.51.24.206', '138.51.24.158', '142.151.158.16', '96.84.38.54', '65.1.254.154', '138.51.24.170',
     '138.51.24.198', '142.1.66.6', '138.51.24.61', '142.151.158.27', '138.51.24.30', '142.150.158.71',
     '142.151.158.22', '142.151.158.216', '142.1.66.250', '138.51.24.175', '142.150.158.181', '138.51.24.136',
     '142.151.158.80', '138.51.24.30', '138.51.24.100', '142.1.66.66', '183.180.13.9', '84.10.128.9', '142.150.158.4',
     '142.1.66.49', '142.150.158.181', '142.1.66.36', '119.23.32.129', '142.1.66.238', '142.151.158.143',
     '142.151.158.214', '138.51.24.121', '138.51.24.58', '142.151.158.148', '142.1.66.195', '142.1.66.192',
     '142.150.158.183', '142.150.158.202', '142.150.158.97', '142.151.158.218', '142.151.158.7', '138.51.24.180',
     '138.51.24.139', '142.1.66.146', '138.51.24.223', '13.251.171.28', '142.150.158.161', '35.229.111.244',
     '142.150.158.150', '103.81.56.46', '142.1.66.31', '138.51.24.42', '142.150.158.201', '138.51.24.241',
     '138.51.24.125', '142.1.66.37', '138.51.24.183', '142.1.66.147', '18.208.137.112', '142.151.158.50',
     '142.1.66.137', '142.1.66.113', '142.150.158.108', '142.151.158.86', '142.150.158.220', '138.51.24.90',
     '142.150.158.242', '138.51.24.219', '142.150.158.58'],

    ['142.150.158.60', '142.150.158.115', '142.1.66.66', '142.150.158.103', '142.151.158.209', '123.56.64.105',
     '142.1.66.95', '142.1.66.203', '221.219.133.15', '142.151.158.188', '142.151.158.15', '142.150.158.39',
     '138.51.24.29', '142.151.158.179', '217.172.12.145', '142.1.66.64', '120.78.194.87', '142.151.158.31',
     '138.51.24.24', '170.187.151.51', '142.1.66.155', '14.132.154.99', '138.51.24.61', '142.1.66.208',
     '142.150.158.17', '142.1.66.200', '142.1.66.192', '119.136.196.24', '142.151.158.11', '142.151.158.90',
     '138.51.24.248', '138.51.24.99', '142.151.158.114', '142.151.158.131', '142.150.158.29', '142.150.158.188',
     '138.51.24.206', '138.51.24.158', '142.1.66.112', '142.151.158.16', '96.84.38.54', '65.1.254.154', '138.51.24.69',
     '138.51.24.170', '138.51.24.198', '142.1.66.6', '138.51.24.61', '142.151.158.27', '138.51.24.30', '142.150.158.71',
     '142.151.158.22', '142.151.158.216', '142.1.66.250', '138.51.24.175', '142.1.66.157', '142.151.158.19',
     '138.51.24.30', '142.1.66.66', '183.180.13.9', '84.10.128.9', '142.150.158.4', '142.1.66.49', '142.150.158.181',
     '142.1.66.36', '142.151.158.246', '119.23.32.129', '14.211.43.122', '142.1.66.238', '142.151.158.143',
     '138.51.24.121', '138.51.24.58', '142.151.158.148', '142.1.66.195', '142.1.66.192', '142.150.158.183',
     '142.150.158.97', '138.51.24.40', '142.151.158.218', '142.1.66.102', '142.151.158.7', '138.51.24.180',
     '138.51.24.139', '142.1.66.146', '138.51.24.223', '13.251.171.28', '138.51.24.248', '142.150.158.161',
     '35.229.111.244', '142.150.158.150', '142.151.158.40', '103.81.56.46', '138.51.24.244', '142.1.66.31',
     '142.151.158.98', '138.51.24.42', '142.150.158.201', '138.51.24.241', '138.51.24.125', '8.129.10.102',
     '142.1.66.37'],

    ['142.150.158.60', '142.1.66.95', '142.1.66.203', '221.219.133.15', '142.151.158.188', '142.150.158.39',
     '142.151.158.179', '142.1.66.64', '142.1.66.155', '138.51.24.61', '142.1.66.208', '142.150.158.17', '142.1.66.200',
     '142.1.66.192', '142.151.158.11', '142.151.158.90', '138.51.24.99', '142.151.158.131', '142.150.158.29',
     '142.150.158.188', '138.51.24.206', '138.51.24.158', '142.151.158.16', '96.84.38.54', '138.51.24.170',
     '138.51.24.198', '138.51.24.61', '142.151.158.27', '138.51.24.30', '142.150.158.71', '142.151.158.22',
     '142.151.158.216', '142.1.66.250', '138.51.24.175', '138.51.24.30', '142.1.66.66', '142.151.158.147',
     '183.180.13.9', '84.10.128.9', '142.150.158.181', '142.1.66.36', '119.23.32.129', '142.151.158.143',
     '138.51.24.121', '138.51.24.58', '142.151.158.148', '142.1.66.195', '142.1.66.192', '142.150.158.183',
     '142.150.158.97', '142.151.158.218', '142.151.158.7', '138.51.24.180', '138.51.24.139', '142.1.66.146',
     '138.51.24.223', '142.150.158.161', '142.150.158.150', '142.1.66.31', '138.51.24.42', '142.150.158.201',
     '138.51.24.241', '138.51.24.125', '142.1.66.37', '138.51.24.183', '142.1.66.147', '142.151.158.50', '142.1.66.137',
     '142.150.158.108', '142.151.158.86', '142.150.158.220', '138.51.24.90', '142.150.158.242', '142.150.158.58',
     '142.1.66.104', '138.51.24.3', '142.1.66.236', '142.151.158.239', '138.51.24.60', '142.1.66.180', '69.75.151.226',
     '142.150.158.177', '142.1.66.44', '119.243.210.175', '142.151.158.204', '142.150.158.43', '142.150.158.130',
     '142.150.158.59', '138.51.24.152', '142.150.158.223', '142.151.158.215', '142.150.158.78', '138.51.24.77',
     '142.1.66.75', '142.1.66.123', '142.150.158.87', '142.1.66.21', '142.1.66.44', '142.151.158.51', '138.51.24.252'],

    ['142.150.158.60', '142.150.158.115', '142.1.66.66', '142.151.158.209', '142.1.66.95', '142.1.66.203',
     '221.219.133.15', '142.151.158.188', '142.151.158.15', '142.150.158.39', '138.51.24.29', '142.151.158.179',
     '142.1.66.64', '138.51.24.24', '142.1.66.155', '14.132.154.99', '138.51.24.61', '142.1.66.208', '142.150.158.17',
     '142.150.158.173', '142.1.66.200', '142.1.66.192', '119.136.196.24', '142.151.158.11', '142.151.158.90',
     '138.51.24.99', '142.151.158.131', '142.150.158.29', '138.51.24.175', '142.150.158.188', '138.51.24.206',
     '138.51.24.158', '142.151.158.16', '96.84.38.54', '138.51.24.170', '138.51.24.198', '138.51.24.61',
     '142.151.158.27', '138.51.24.30', '142.150.158.71', '142.151.158.22', '142.151.158.216', '142.1.66.250',
     '138.51.24.175', '142.1.66.157', '142.151.158.80', '142.151.158.19', '138.51.24.30', '138.51.24.100',
     '142.150.158.16', '142.1.66.66', '183.180.13.9', '84.10.128.9', '142.150.158.181', '142.1.66.36', '119.23.32.129',
     '14.211.43.122', '142.1.66.238', '142.151.158.143', '138.51.24.121', '138.51.24.58', '142.151.158.148',
     '142.1.66.195', '142.1.66.192', '142.150.158.183', '142.150.158.202', '142.150.158.97', '142.151.158.218',
     '142.151.158.7', '138.51.24.180', '138.51.24.139', '142.1.66.146', '138.51.24.223', '142.150.158.161',
     '142.150.158.150', '142.1.66.31', '138.51.24.42', '142.150.158.201', '138.51.24.241', '138.51.24.125',
     '142.1.66.37', '138.51.24.183', '142.1.66.147', '142.151.158.50', '142.1.66.137', '142.1.66.113',
     '142.150.158.108', '142.151.158.86', '142.150.158.220', '138.51.24.90', '142.150.158.242', '142.150.158.58',
     '142.1.66.104', '138.51.24.3', '142.1.66.236', '142.151.158.239', '138.51.24.60', '142.1.66.180', '69.75.151.226',
     '52.54.28.106']
]

# Censys search
h = CensysHosts()
s = SearchClient()
c = CensysCertificates
censys_query_list = [
    ["Evilginx Infrastructure", "services.http.response.body_hash='sha1:b18d778b4e4b6bf1fd5b2d790c941270145a6a6d'"],
    ["IcedID Infrastructure", "services.tls.certificates.leaf_data.subject_dn='CN=localhost, C=AU, ST=Some-State, O=Internet Widgits Pty Ltd'"],
    ["Gophish Infrastructure", "services.jarm.fingerprint: 28d28d28d00028d00041d28d28d41dd279b0cf765af27fa62e66d7c8281124"],
    ["Viper Infrastructure", "services.http.response.body_hash='sha1:cd40dbcdae84b1c8606f29342066547069ed5a33'"],
    ["ARL/Assessment Reconsassaince Tool Infrastructure", "services.http.response.body_hash='sha1:465811beb4dab8e1df19cf2ad3ed92bfd2194de2'"],
    ["Night Hawk C2", "services.http.response.body_hash='sha1:057f3b5488605b4d224d038e340866e2cdfed4a3'"],
    ["ShadowPad C2 Infrastructure", "services.tls.certificates.leaf_data.subject_dn='C=CN, ST=myprovince, L=mycity, O=myorganization, OU=mygroup, CN=myServer'"],
    ["Async Rat C2 Infrastructure", "services.tls.certificates.leaf_data.issuer.common_name:AsyncRat"],
    ["Meterpreter C2 Infrastructure", "services.http.response.body_hash='sha1:057f3b5488605b4d224d038e340866e2cdfed4a3'"]
]
censys_ip_list = [
	['50.116.35.87', '94.140.115.145'],
	['1.14.140.155', '1.15.84.185', '1.15.182.29', '1.15.184.121', '1.117.163.174', '2.58.200.73', '3.8.88.67', '3.14.123.72', '3.20.85.187', '3.32.148.75', '3.37.201.128', '3.86.100.158', '3.86.202.114', '3.92.34.94', '3.92.164.121', '3.92.205.27', '3.94.20.184', '3.110.127.240', '3.120.122.210', '3.126.118.206', '3.138.63.169', '3.140.139.228', '3.144.85.186', '3.220.36.103', '3.234.60.33', '4.34.48.69', '4.227.232.81', '4.234.155.107', '5.43.231.17', '5.43.231.54', '5.43.231.129', '5.43.231.199', '5.43.231.229', '5.75.253.229', '5.157.80.242', '5.181.156.97', '5.183.4.60', '5.196.28.55', '5.254.124.152', '8.9.8.197', '8.130.15.214', '8.134.11.186', '8.134.78.143', '13.38.249.22', '13.39.97.128', '13.50.110.84', '13.52.249.97', '13.57.123.84', '13.59.229.117', '13.92.183.178', '13.112.11.72', '13.125.217.105', '13.210.197.16', '13.215.120.134', '13.229.69.42', '13.232.180.201', '13.232.249.82', '13.239.91.78', '15.206.255.116', '15.229.22.209', '15.236.5.104', '18.117.247.218', '18.135.30.45', '18.144.170.50', '18.167.137.68', '18.176.176.35', '18.181.186.82', '18.190.91.186', '18.192.125.91', '18.192.246.188', '18.202.233.222', '18.209.36.160', '18.216.174.51', '18.223.23.68', '18.231.190.242', '18.237.195.61', '20.0.218.212', '20.1.184.34', '20.4.197.194', '20.10.29.44', '20.11.84.209', '20.28.192.17', '20.64.170.184', '20.70.121.154', '20.105.158.55', '20.106.176.182', '20.108.95.190', '20.120.127.159', '20.122.180.23', '20.124.244.64', '20.172.175.211', '20.193.131.228', '20.199.18.237', '20.205.0.55', '20.205.178.4', '20.210.163.88', '20.212.177.228', '20.214.252.63', '20.218.79.183', '20.224.225.27'],
	['1.14.198.89', '1.15.70.106', '1.117.49.216', '1.117.145.220', '1.117.157.251', '8.134.152.147', '8.210.80.193', '8.218.85.22', '14.29.238.33', '18.162.89.124', '20.157.210.39', '20.187.252.59', '23.224.181.252', '23.225.213.82', '23.225.213.83', '23.225.213.84', '23.225.213.85', '23.225.213.86', '39.99.154.30', '39.108.110.213', '42.192.77.235', '42.192.129.98', '43.138.230.14', '43.139.185.117', '43.139.190.82', '43.139.225.42', '43.139.227.213', '43.139.241.58', '43.142.97.72', '43.142.186.89', '43.142.255.186', '43.143.107.163', '43.143.136.106', '43.143.218.175', '43.143.230.92', '45.81.128.189', '45.204.1.36', '47.94.20.209', '47.94.151.18', '47.95.1.240', '47.100.82.209', '47.107.97.87', '49.0.250.177', '49.234.44.249', '49.235.67.11', '64.27.27.97', '81.68.142.187', '81.68.159.196', '81.68.161.22', '81.70.204.117', '89.208.105.103', '96.45.170.41', '101.34.17.63', '101.34.19.31', '101.34.26.70', '101.43.101.36', '101.132.180.62', '101.200.236.51', '103.233.253.147', '106.52.235.23', '107.173.7.34', '110.40.137.156', '110.40.211.239', '110.42.133.224', '114.96.100.53', '115.159.200.81', '116.63.163.221', '116.198.47.207', '116.204.72.140', '116.205.244.33', '116.211.120.25', '119.3.176.226', '119.8.118.92', '119.91.26.244', '119.147.37.195', '120.46.212.231', '120.48.96.183', '121.4.138.158', '121.5.63.55', '121.5.196.25', '121.37.255.169', '121.199.7.166', '124.70.47.66', '124.71.84.65', '124.71.135.11', '124.71.152.140', '124.71.155.49', '124.223.10.136', '124.223.17.79', '124.223.60.44', '124.223.114.201', '139.144.79.120', '141.147.159.142', '146.190.32.151', '150.158.31.222', '150.158.40.14', '152.136.109.106', '152.136.149.124', '154.23.218.120', '154.198.211.153'],
	['1.12.43.250', '1.12.49.235', '1.12.52.234', '1.12.58.184', '1.12.64.90', '1.12.69.127', '1.12.74.222', '1.12.77.57', '1.12.219.193', '1.12.222.32', '1.12.226.211', '1.12.228.75', '1.12.230.233', '1.12.235.152', '1.12.240.20', '1.12.248.51', '1.13.15.130', '1.13.81.69', '1.13.172.47', '1.13.175.57', '1.14.17.39', '1.14.58.225', '1.14.59.137', '1.14.64.27', '1.14.71.7', '1.14.92.194', '1.14.96.24', '1.14.121.17', '1.14.123.106', '1.14.125.141', '1.14.137.204', '1.15.7.20', '1.15.38.24', '1.15.47.141', '1.15.55.240', '1.15.60.124', '1.15.63.95', '1.15.76.54', '1.15.80.153', '1.15.84.185', '1.15.85.206', '1.15.99.249', '1.15.105.133', '1.15.122.126', '1.15.139.215', '1.15.145.11', '1.15.149.194', '1.15.232.177', '1.15.235.58', '1.15.236.86', '1.15.242.49', '1.116.78.105', '1.116.91.200', '1.116.123.8', '1.116.126.5', '1.116.135.161', '1.116.156.228', '1.116.183.208', '1.116.192.134', '1.117.20.173', '1.117.58.110', '1.117.64.224', '1.117.70.16', '1.117.71.188', '1.117.74.246', '1.117.79.196', '1.117.87.247', '1.117.147.17', '1.117.219.72', '1.117.224.4', '1.117.233.48', '1.117.234.23', '2.56.242.74', '2.59.214.36', '4.193.139.200', '5.180.182.82', '8.9.5.182', '8.45.48.5', '8.45.48.106', '8.129.17.115', '8.129.221.143', '8.130.8.218', '8.130.11.179', '8.130.15.74', '8.130.17.76', '8.130.17.203', '8.130.19.209', '8.130.21.89', '8.130.33.119', '8.130.33.247', '8.130.51.165', '8.130.54.103', '8.130.55.150', '8.130.70.109', '8.130.71.181', '8.130.73.127', '8.130.76.211', '8.130.79.85', '8.130.84.67', '8.130.84.172'],
	['1.15.70.106', '1.15.220.242', '2.56.10.15', '3.83.39.238', '8.218.215.228', '23.23.172.96', '23.94.131.51', '24.137.215.168', '42.192.59.199', '43.138.105.151', '43.143.95.143', '43.154.176.5', '43.156.138.63', '45.32.107.192', '45.56.162.71', '45.76.105.196', '45.76.202.239', '45.82.78.106', '45.134.169.149', '46.105.58.9', '47.92.32.57', '47.92.241.175', '47.103.49.39', '49.4.67.142', '49.232.128.4', '51.68.138.162', '54.78.94.171', '54.185.160.63', '62.106.77.10', '66.152.160.97', '69.195.139.2', '72.142.102.168', '80.78.22.127', '81.70.204.117', '82.156.55.208', '91.208.162.10', '94.103.89.161', '101.34.90.47', '101.35.153.30', '101.35.177.86', '101.37.24.170', '101.42.178.86', '101.43.101.36', '103.96.129.116', '104.156.149.222', '107.148.131.222', '109.248.150.25', '111.9.220.114', '111.172.248.242', '114.118.5.135', '114.118.5.138', '116.204.211.130', '116.205.244.33', '118.193.78.234', '120.46.223.146', '120.79.172.254', '121.37.101.95', '124.70.199.215', '124.71.234.74', '124.222.122.203', '124.223.13.142', '124.223.17.79', '125.124.138.141', '128.199.99.111', '134.122.2.188', '134.122.186.146', '138.201.220.187', '139.155.2.105', '139.180.159.55', '139.180.169.177', '139.196.124.59', '140.82.18.163', '142.93.156.132', '143.110.251.110', '144.34.180.85', '146.190.92.159', '146.190.107.14', '149.28.94.116', '149.28.157.192', '149.127.215.86', '150.158.25.152', '154.19.200.39', '154.23.218.120', '155.94.163.251', '156.234.180.234', '157.245.40.62', '159.75.70.33', '159.75.205.115', '164.52.115.109', '165.22.9.60', '167.172.145.51', '172.94.111.34', '172.104.97.100', '173.82.206.55', '174.138.113.101', '175.178.213.24', '180.76.186.84', '185.29.8.159', '185.185.68.234', '185.186.245.144'],
	['3.19.1.60', '3.219.38.25', '18.193.11.42', '39.96.58.23', '49.128.198.7', '52.28.180.133', '52.169.150.122', '58.56.56.121', '60.216.13.117', '98.142.251.205', '103.22.255.14', '114.255.80.175', '120.46.142.252', '120.224.32.49', '121.36.88.114', '122.9.97.58', '122.9.110.167', '123.232.44.15', '124.133.230.153', '193.200.16.184', '220.248.252.114', '222.173.28.228', '223.99.7.180'],
	['2.224.144.191', '5.196.35.57', '5.249.165.85', '15.204.170.1', '20.86.57.70', '20.150.149.137', '20.169.37.196', '23.133.216.180', '40.113.131.31', '42.117.250.245', '45.58.190.125', '45.80.158.57', '45.80.158.65', '45.80.158.183', '45.137.22.36', '45.137.22.58', '45.137.22.236', '45.138.16.48', '45.138.16.133', '45.138.16.161', '45.138.16.162', '45.138.16.202', '45.138.16.233', '45.138.16.235', '45.141.215.81', '45.154.98.110', '45.154.98.151', '45.154.98.192', '45.154.98.194', '45.154.98.201', '46.246.80.16', '51.38.247.74', '51.81.24.93', '51.83.231.254', '51.89.204.67', '51.89.207.166', '51.161.59.75', '51.161.105.119', '64.44.57.12', '64.56.68.152', '65.21.177.234', '65.108.149.137', '66.94.109.58', '66.94.118.174', '70.36.110.159', '85.206.172.156', '85.208.136.58', '85.215.172.173', '85.215.190.69', '85.215.205.213', '86.48.18.223', '92.204.146.31', '95.214.24.32', '95.214.24.134', '95.214.27.226', '103.195.238.95', '103.195.238.235', '108.143.240.80', '109.206.243.198', '109.230.238.142', '120.146.185.63', '130.211.201.48', '135.148.113.4', '136.243.108.104', '138.201.81.121', '140.82.55.70', '141.255.150.132', '142.202.240.126', '146.59.161.194', '147.185.221.180', '149.202.0.249', '154.53.45.198', '163.172.225.185', '167.179.77.194', '172.81.60.205', '185.29.8.3', '185.81.157.14', '185.81.157.105', '185.81.157.135', '185.81.157.168', '185.81.157.244', '185.241.208.99', '185.241.208.104', '185.252.178.121', '190.213.78.26', '191.101.130.28', '192.99.180.181', '192.119.108.78', '192.188.88.248', '193.23.161.246', '193.142.146.212', '193.164.7.109', '194.26.192.22', '194.87.151.134', '195.133.201.62', '198.23.145.12', '198.23.212.148', '198.244.251.230', '207.32.217.71', '209.25.142.180'],
	['1.15.70.106', '1.15.220.242', '2.56.10.15', '3.83.39.238', '8.218.215.228', '23.23.172.96', '23.94.131.51', '24.137.215.168', '42.192.59.199', '43.138.105.151', '43.143.95.143', '43.154.176.5', '43.156.138.63', '45.32.107.192', '45.56.162.71', '45.76.105.196', '45.76.202.239', '45.82.78.106', '45.134.169.149', '46.105.58.9', '47.92.32.57', '47.92.241.175', '47.103.49.39', '49.4.67.142', '49.232.128.4', '51.68.138.162', '54.78.94.171', '54.185.160.63', '62.106.77.10', '66.152.160.97', '69.195.139.2', '72.142.102.168', '80.78.22.127', '81.70.204.117', '82.156.55.208', '91.208.162.10', '94.103.89.161', '101.34.90.47', '101.35.153.30', '101.35.177.86', '101.37.24.170', '101.42.178.86', '101.43.101.36', '103.96.129.116', '104.156.149.222', '107.148.131.222', '109.248.150.25', '111.9.220.114', '111.172.248.242', '114.118.5.135', '114.118.5.138', '116.204.211.130', '116.205.244.33', '118.193.78.234', '120.46.223.146', '120.79.172.254', '121.37.101.95', '124.70.199.215', '124.71.234.74', '124.222.122.203', '124.223.13.142', '124.223.17.79', '125.124.138.141', '128.199.99.111', '134.122.2.188', '134.122.186.146', '138.201.220.187', '139.155.2.105', '139.180.159.55', '139.180.169.177', '139.196.124.59', '140.82.18.163', '142.93.156.132', '143.110.251.110', '144.34.180.85', '146.190.92.159', '146.190.107.14', '149.28.94.116', '149.28.157.192', '149.127.215.86', '150.158.25.152', '154.19.200.39', '154.23.218.120', '155.94.163.251', '156.234.180.234', '157.245.40.62', '159.75.70.33', '159.75.205.115', '164.52.115.109', '165.22.9.60', '167.172.145.51', '172.94.111.34', '172.104.97.100', '173.82.206.55', '174.138.113.101', '175.178.213.24', '180.76.186.84', '185.29.8.159', '185.185.68.234', '185.186.245.144'],
]

# Read CSV
input_ip_list = list()
with open("ip.csv", newline='') as csvfile:
    reader = csv.DictReader(csvfile)
    data = [row for row in reader]
    for datum in data:
        input_ip_list.append(datum["IP"])


# analyze from Shodan
def shodan_analysis():
    try:
        shodan_ip_list = list()

        api = shodan.Shodan(shodan_api_key)

        for qu in shodan_query_list:
            query = " ".join(qu[1])
            result = api.search(query)

            result_list = list()
            for service in result["matches"]:
                result_list.append(service["ip_str"])

            shodan_ip_list.append(result_list)

    except Exception as e:
        print("Shodan Error: %s" % e)


# analyze from Censys
def censys_analysis():
    for query_list in censys_query_list:
        query = h.search(query_list[1])
        results = query()

        result_list = list()
        for result in results:
            result_list.append(result["ip"])
        censys_ip_list.append(result_list)


for ip in input_ip_list:
    infra_list = list()

    idx = 0
    for shodan_ip in shodan_ip_list:
        if ip in shodan_ip:
            infra_list.append(shodan_query_list[idx][0])
        idx += 1

    idx = 0
    for censys_ip in censys_ip_list:
        if ip in censys_ip:
            infra_list.append(censys_query_list[idx][0])
        idx += 1

    if len(infra_list) > 0:
        result_dict[ip] = infra_list

print(result_dict)


#shodan_analysis()
#censys_analysis()
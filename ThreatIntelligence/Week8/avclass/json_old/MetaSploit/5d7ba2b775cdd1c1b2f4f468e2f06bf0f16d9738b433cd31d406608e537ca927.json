{"data": {"attributes": {"type_description": "Powershell", "tlsh": "T1E081E99CABE7BAADA1835047FD3DE8410E6C0F62D5C93C00A4F463A62187C74F257A4B", "vhash": "586634ade809a6e6f50aa7fd75fdd737", "type_tags": ["source", "powershell", "ps", "ps1"], "crowdsourced_yara_results": [{"description": "This signature detects the presence of a number of Windows API functionality often seen within embedded executables. When this signature alerts on an executable, it is not an indication of malicious behavior. However, if seen firing in other file types, deeper investigation may be warranted.", "source": "https://github.com/InQuest/yara-rules-vt", "author": "InQuest Labs", "ruleset_name": "Windows_API_Function", "rule_name": "Windows_API_Function", "ruleset_id": "0122a7f913"}], "names": ["5d7ba2b775cdd1c1b2f4f468e2f06bf0f16d9738b433cd31d406608e537ca927.ps1"], "last_modification_date": 1681950474, "type_tag": "powershell", "times_submitted": 2, "total_votes": {"harmless": 0, "malicious": 0}, "size": 4184, "popular_threat_classification": {"suggested_threat_label": "trojan.boxter/powershell", "popular_threat_category": [{"count": 11, "value": "trojan"}, {"count": 4, "value": "dropper"}], "popular_threat_name": [{"count": 8, "value": "boxter"}, {"count": 5, "value": "powershell"}, {"count": 2, "value": "rozena"}]}, "last_submission_date": 1681857967, "sigma_analysis_results": [{"rule_title": "Potential WinAPI Calls Via PowerShell Scripts", "rule_source": "Sigma Integrated Rule Set (GitHub)", "match_context": [{"values": {"EventID": "4104", "ScriptBlockId": "df96c547-8772-4de9-aa4d-8288dad93f66", "ScriptBlockText": "5d7ba2b775cdd1c1b2f4f468e2f06bf0f16d9738b433cd31d406608e537ca927", "MessageNumber": "1", "MessageTotal": "1", "Path": "C:\\Users\\azure\\Downloads\\5d7ba2b775cdd1c1b2f4f468e2f06bf0f16d9738b433cd31d406608e537ca927.ps1"}}], "rule_level": "high", "rule_id": "6c44b18934e9ddd288d035d35a258c41fce2d5f5ebafc55ff866a95fb78db9c2", "rule_author": "Nikita Nazarov, oscd.community, Tim Shelton", "rule_description": "Detects use of WinAPI Functions in PowerShell scripts"}, {"rule_title": "Change PowerShell Policies to an Insecure Level", "rule_source": "Sigma Integrated Rule Set (GitHub)", "match_context": [{"values": {"TerminalSessionId": "1", "ProcessGuid": "{C784477D-D584-643E-0C06-000000003400}", "ProcessId": "6372", "Product": "Microsoft\\xae Windows\\xae Operating System", "Description": "Windows PowerShell", "Company": "Microsoft Corporation", "ParentProcessGuid": "{C784477D-4AA8-6407-6C00-000000003400}", "User": "DESKTOP-B0T93D6\\george", "Hashes": "MD5=95000560239032BC68B4C2FDFCDEF913,SHA256=D3F8FADE829D2B7BD596C4504A6DAE5C034E789B6A3DEFBE013BDA7D14466677,IMPHASH=741776AACCFC5B71FF59832DCDCACE0F", "OriginalFileName": "PowerShell.EXE", "ParentImage": "C:\\Windows\\explorer.exe", "FileVersion": "10.0.17134.1 (WinBuild.160101.0800)", "ParentProcessId": "4972", "CurrentDirectory": "C:\\Users\\george\\Desktop\\", "CommandLine": "\"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" -noLogo -ExecutionPolicy unrestricted -file \"C:\\Users\\george\\Desktop\\75cdd1c1b2f4f468e2f06bf0f16d9738b433cd31d406608e537ca927.ps1\"", "EventID": "1", "LogonGuid": "C784477D-4AA7-6407-5FBC-030000000000", "LogonId": "244831", "Image": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "IntegrityLevel": "High", "ParentCommandLine": "C:\\Windows\\Explorer.EXE", "UtcTime": "1681839492", "RuleName": "-"}}], "rule_level": "medium", "rule_id": "06b48fa7870d38bdf92b4d4a9b9c4a4df779bd405fdc5ba0e70911df20027ce1", "rule_author": "frack113", "rule_description": "Detects use of executionpolicy option to set insecure policies"}], "meaningful_name": "5d7ba2b775cdd1c1b2f4f468e2f06bf0f16d9738b433cd31d406608e537ca927.ps1", "trid": [{"file_type": "file seems to be plain text/ASCII", "probability": 0.0}], "sigma_analysis_summary": {"Sigma Integrated Rule Set (GitHub)": {"high": 1, "medium": 1, "critical": 0, "low": 0}}, "sandbox_verdicts": {"C2AE": {"category": "malicious", "confidence": 50, "sandbox_name": "C2AE", "malware_classification": ["MALWARE"], "malware_names": ["PowershellMeter"]}}, "sha256": "5d7ba2b775cdd1c1b2f4f468e2f06bf0f16d9738b433cd31d406608e537ca927", "type_extension": "ps1", "tags": ["powershell", "direct-cpu-clock-access", "detect-debug-environment", "long-sleeps", "runtime-modules"], "last_analysis_date": 1681839376, "unique_sources": 2, "first_submission_date": 1681839376, "ssdeep": "96:9gOOMM3vvOmIecH1G7NYdpzKTJIunKGjNa0lgYR50lh:DS/vOkcH1GZ08lINihPROf", "md5": "bfa6fe55cc07eaa503c2d19040ec3a73", "sha1": "1869ef1f38d5668d656662cdf9e9bf497d48865e", "magic": "ASCII text, with very long lines, with CRLF line terminators", "powershell_info": {"dotnet_calls": ["System.Convert", "System.MulticastDelegate", "System.Reflection.CallingConventions", "System.Reflection.Emit.AssemblyBuilderAccess", "System.Runtime.InteropServices.HandleRef", "System.Runtime.InteropServices.Marshal"], "cmdlets": ["new-object", "set-strictmode", "where-object"], "functions": ["func_get_delegate_type", "func_get_proc_address"]}, "last_analysis_stats": {"harmless": 0, "type-unsupported": 15, "suspicious": 0, "confirmed-timeout": 0, "timeout": 0, "failure": 0, "malicious": 33, "undetected": 26}, "last_analysis_results": {"Bkav": {"category": "undetected", "engine_name": "Bkav", "engine_version": "1.3.0.9899", "result": null, "method": "blacklist", "engine_update": "20230418"}, "Lionic": {"category": "undetected", "engine_name": "Lionic", "engine_version": "7.5", "result": null, "method": "blacklist", "engine_update": "20230418"}, "Elastic": {"category": "type-unsupported", "engine_name": "Elastic", "engine_version": "4.0.85", "result": null, "method": "blacklist", "engine_update": "20230413"}, "ClamAV": {"category": "undetected", "engine_name": "ClamAV", "engine_version": "1.0.1.0", "result": null, "method": "blacklist", "engine_update": "20230418"}, "CMC": {"category": "undetected", "engine_name": "CMC", "engine_version": "2.4.2022.1", "result": null, "method": "blacklist", "engine_update": "20230418"}, "CAT-QuickHeal": {"category": "malicious", "engine_name": "CAT-QuickHeal", "engine_version": "22.00", "result": "Script.Trojan.Script.42926", "method": "blacklist", "engine_update": "20230417"}, "ALYac": {"category": "malicious", "engine_name": "ALYac", "engine_version": "1.1.3.1", "result": "Heur.BZC.PZQ.Boxter.826.D3D6CC0B", "method": "blacklist", "engine_update": "20230418"}, "Malwarebytes": {"category": "undetected", "engine_name": "Malwarebytes", "engine_version": "4.5.5.54", "result": null, "method": "blacklist", "engine_update": "20230418"}, "Zillya": {"category": "undetected", "engine_name": "Zillya", "engine_version": "2.0.0.4854", "result": null, "method": "blacklist", "engine_update": "20230417"}, "Sangfor": {"category": "malicious", "engine_name": "Sangfor", "engine_version": "2.23.0.0", "result": "Malware.Generic-PS.Save.d41b8e2c", "method": "blacklist", "engine_update": "20230417"}, "K7AntiVirus": {"category": "undetected", "engine_name": "K7AntiVirus", "engine_version": "12.81.47791", "result": null, "method": "blacklist", "engine_update": "20230418"}, "Alibaba": {"category": "type-unsupported", "engine_name": "Alibaba", "engine_version": "0.3.0.5", "result": null, "method": "blacklist", "engine_update": "20190527"}, "K7GW": {"category": "undetected", "engine_name": "K7GW", "engine_version": "12.81.47791", "result": null, "method": "blacklist", "engine_update": "20230418"}, "Trustlook": {"category": "type-unsupported", "engine_name": "Trustlook", "engine_version": "1.0", "result": null, "method": "blacklist", "engine_update": "20230418"}, "BitDefenderTheta": {"category": "undetected", "engine_name": "BitDefenderTheta", "engine_version": "7.2.37796.0", "result": null, "method": "blacklist", "engine_update": "20230418"}, "VirIT": {"category": "undetected", "engine_name": "VirIT", "engine_version": "9.5.431", "result": null, "method": "blacklist", "engine_update": "20230418"}, "Cyren": {"category": "malicious", "engine_name": "Cyren", "engine_version": "6.5.1.2", "result": "PSH/Agent.BO", "method": "blacklist", "engine_update": "20230418"}, "SymantecMobileInsight": {"category": "type-unsupported", "engine_name": "SymantecMobileInsight", "engine_version": "2.0", "result": null, "method": "blacklist", "engine_update": "20230119"}, "Symantec": {"category": "malicious", "engine_name": "Symantec", "engine_version": "1.19.0.0", "result": "Backdoor.Cobalt", "method": "blacklist", "engine_update": "20230418"}, "tehtris": {"category": "type-unsupported", "engine_name": "tehtris", "engine_version": null, "result": null, "method": "blacklist", "engine_update": "20230418"}, "ESET-NOD32": {"category": "malicious", "engine_name": "ESET-NOD32", "engine_version": "27090", "result": "Win32/Rozena.ACE", "method": "blacklist", "engine_update": "20230418"}, "APEX": {"category": "type-unsupported", "engine_name": "APEX", "engine_version": "6.408", "result": null, "method": "blacklist", "engine_update": "20230416"}, "TrendMicro-HouseCall": {"category": "undetected", "engine_name": "TrendMicro-HouseCall", "engine_version": "10.0.0.1040", "result": null, "method": "blacklist", "engine_update": "20230418"}, "Avast": {"category": "malicious", "engine_name": "Avast", "engine_version": "22.11.7701.0", "result": "PwrSh:Dropper-F [Trj]", "method": "blacklist", "engine_update": "20230418"}, "Cynet": {"category": "malicious", "engine_name": "Cynet", "engine_version": "4.0.0.27", "result": "Malicious (score: 99)", "method": "blacklist", "engine_update": "20230418"}, "Kaspersky": {"category": "malicious", "engine_name": "Kaspersky", "engine_version": "22.0.1.28", "result": "HEUR:Trojan.PowerShell.Agent.gen", "method": "blacklist", "engine_update": "20230418"}, "BitDefender": {"category": "malicious", "engine_name": "BitDefender", "engine_version": "7.2", "result": "Heur.BZC.PZQ.Boxter.826.D3D6CC0B", "method": "blacklist", "engine_update": "20230418"}, "NANO-Antivirus": {"category": "malicious", "engine_name": "NANO-Antivirus", "engine_version": "1.0.146.25755", "result": "Trojan.Script.Rozena.haktke", "method": "blacklist", "engine_update": "20230418"}, "ViRobot": {"category": "undetected", "engine_name": "ViRobot", "engine_version": "2014.3.20.0", "result": null, "method": "blacklist", "engine_update": "20230418"}, "MicroWorld-eScan": {"category": "malicious", "engine_name": "MicroWorld-eScan", "engine_version": "14.0.409.0", "result": "Heur.BZC.PZQ.Boxter.826.D3D6CC0B", "method": "blacklist", "engine_update": "20230418"}, "Tencent": {"category": "malicious", "engine_name": "Tencent", "engine_version": "1.0.0.1", "result": "Win32.Trojan.Agent.Iajl", "method": "blacklist", "engine_update": "20230418"}, "TACHYON": {"category": "undetected", "engine_name": "TACHYON", "engine_version": "2023-04-18.02", "result": null, "method": "blacklist", "engine_update": "20230418"}, "Emsisoft": {"category": "malicious", "engine_name": "Emsisoft", "engine_version": "2022.6.0.32461", "result": "Heur.BZC.PZQ.Boxter.826.D3D6CC0B (B)", "method": "blacklist", "engine_update": "20230418"}, "Baidu": {"category": "undetected", "engine_name": "Baidu", "engine_version": "1.0.0.2", "result": null, "method": "blacklist", "engine_update": "20190318"}, "F-Secure": {"category": "malicious", "engine_name": "F-Secure", "engine_version": "18.10.1137.128", "result": "Trojan.TR/Coblat.G1", "method": "blacklist", "engine_update": "20230418"}, "DrWeb": {"category": "malicious", "engine_name": "DrWeb", "engine_version": "7.0.59.12300", "result": "PowerShell.Packed.46", "method": "blacklist", "engine_update": "20230418"}, "VIPRE": {"category": "malicious", "engine_name": "VIPRE", "engine_version": "6.0.0.35", "result": "Heur.BZC.PZQ.Boxter.826.D3D6CC0B", "method": "blacklist", "engine_update": "20230418"}, "TrendMicro": {"category": "malicious", "engine_name": "TrendMicro", "engine_version": "11.0.0.1006", "result": "Trojan.PS1.COBEACON.SMYXAK-B", "method": "blacklist", "engine_update": "20230418"}, "McAfee-GW-Edition": {"category": "malicious", "engine_name": "McAfee-GW-Edition", "engine_version": "v2021.2.0+4045", "result": "BehavesLike.PS.Dropper.xn", "method": "blacklist", "engine_update": "20230418"}, "SentinelOne": {"category": "type-unsupported", "engine_name": "SentinelOne", "engine_version": "23.2.0.1", "result": null, "method": "blacklist", "engine_update": "20230404"}, "Trapmine": {"category": "type-unsupported", "engine_name": "Trapmine", "engine_version": "4.0.14.446", "result": null, "method": "blacklist", "engine_update": "20230412"}, "FireEye": {"category": "malicious", "engine_name": "FireEye", "engine_version": "35.24.1.0", "result": "Heur.BZC.PZQ.Boxter.826.D3D6CC0B", "method": "blacklist", "engine_update": "20230418"}, "Sophos": {"category": "malicious", "engine_name": "Sophos", "engine_version": "2.1.2.0", "result": "ATK/Tlaboc-A", "method": "blacklist", "engine_update": "20230418"}, "Paloalto": {"category": "type-unsupported", "engine_name": "Paloalto", "engine_version": "0.9.0.1003", "result": null, "method": "blacklist", "engine_update": "20230418"}, "Avast-Mobile": {"category": "type-unsupported", "engine_name": "Avast-Mobile", "engine_version": "230418-02", "result": null, "method": "blacklist", "engine_update": "20230418"}, "Jiangmin": {"category": "malicious", "engine_name": "Jiangmin", "engine_version": "16.0.100", "result": "Trojan.Cometer.om", "method": "blacklist", "engine_update": "20230417"}, "Webroot": {"category": "type-unsupported", "engine_name": "Webroot", "engine_version": "1.0.0.403", "result": null, "method": "blacklist", "engine_update": "20230418"}, "Avira": {"category": "malicious", "engine_name": "Avira", "engine_version": "8.3.3.16", "result": "TR/Coblat.G1", "method": "blacklist", "engine_update": "20230418"}, "Antiy-AVL": {"category": "undetected", "engine_name": "Antiy-AVL", "engine_version": "3.0", "result": null, "method": "blacklist", "engine_update": "20230418"}, "Microsoft": {"category": "malicious", "engine_name": "Microsoft", "engine_version": "1.1.20200.4", "result": "TrojanDropper:PowerShell/Cobacis.B", "method": "blacklist", "engine_update": "20230418"}, "Gridinsoft": {"category": "undetected", "engine_name": "Gridinsoft", "engine_version": "1.0.114.174", "result": null, "method": "blacklist", "engine_update": "20230418"}, "Xcitium": {"category": "undetected", "engine_name": "Xcitium", "engine_version": "35578", "result": null, "method": "blacklist", "engine_update": "20230418"}, "Arcabit": {"category": "malicious", "engine_name": "Arcabit", "engine_version": "2022.0.0.18", "result": "Heur.BZC.PZQ.Boxter.826.D3D6CC0B", "method": "blacklist", "engine_update": "20230418"}, "SUPERAntiSpyware": {"category": "undetected", "engine_name": "SUPERAntiSpyware", "engine_version": "5.6.0.1032", "result": null, "method": "blacklist", "engine_update": "20230416"}, "ZoneAlarm": {"category": "malicious", "engine_name": "ZoneAlarm", "engine_version": "1.0", "result": "HEUR:Trojan.PowerShell.Agent.gen", "method": "blacklist", "engine_update": "20230418"}, "GData": {"category": "malicious", "engine_name": "GData", "engine_version": "A:25.35667B:27.31376", "result": "Heur.BZC.PZQ.Boxter.826.D3D6CC0B", "method": "blacklist", "engine_update": "20230418"}, "Google": {"category": "malicious", "engine_name": "Google", "engine_version": "1681837264", "result": "Detected", "method": "blacklist", "engine_update": "20230418"}, "BitDefenderFalx": {"category": "type-unsupported", "engine_name": "BitDefenderFalx", "engine_version": "2.0.936", "result": null, "method": "blacklist", "engine_update": "20230203"}, "AhnLab-V3": {"category": "malicious", "engine_name": "AhnLab-V3", "engine_version": "3.23.2.10388", "result": "Trojan/PowerShell.CobaltStrike.S1463", "method": "blacklist", "engine_update": "20230418"}, "Acronis": {"category": "undetected", "engine_name": "Acronis", "engine_version": "1.2.0.114", "result": null, "method": "blacklist", "engine_update": "20230219"}, "McAfee": {"category": "undetected", "engine_name": "McAfee", "engine_version": "6.0.6.653", "result": null, "method": "blacklist", "engine_update": "20230418"}, "MAX": {"category": "malicious", "engine_name": "MAX", "engine_version": "2023.1.4.1", "result": "malware (ai score=86)", "method": "blacklist", "engine_update": "20230418"}, "DeepInstinct": {"category": "type-unsupported", "engine_name": "DeepInstinct", "engine_version": "3.1.0.15", "result": null, "method": "blacklist", "engine_update": "20230418"}, "VBA32": {"category": "undetected", "engine_name": "VBA32", "engine_version": "5.0.0", "result": null, "method": "blacklist", "engine_update": "20230418"}, "Cylance": {"category": "type-unsupported", "engine_name": "Cylance", "engine_version": "2.0.0.0", "result": null, "method": "blacklist", "engine_update": "20230412"}, "Zoner": {"category": "undetected", "engine_name": "Zoner", "engine_version": "2.2.2.0", "result": null, "method": "blacklist", "engine_update": "20230418"}, "Rising": {"category": "malicious", "engine_name": "Rising", "engine_version": "25.0.0.27", "result": "Trojan.CobaltStrike/PS!1.D1D5 (CLASSIC)", "method": "blacklist", "engine_update": "20230418"}, "Yandex": {"category": "undetected", "engine_name": "Yandex", "engine_version": "5.5.2.24", "result": null, "method": "blacklist", "engine_update": "20230418"}, "Ikarus": {"category": "malicious", "engine_name": "Ikarus", "engine_version": "6.1.14.0", "result": "Win32.Outbreak", "method": "blacklist", "engine_update": "20230418"}, "MaxSecure": {"category": "undetected", "engine_name": "MaxSecure", "engine_version": "1.0.0.1", "result": null, "method": "blacklist", "engine_update": "20230415"}, "Fortinet": {"category": "undetected", "engine_name": "Fortinet", "engine_version": "6.4.258.0", "result": null, "method": "blacklist", "engine_update": "20230418"}, "AVG": {"category": "malicious", "engine_name": "AVG", "engine_version": "22.11.7701.0", "result": "PwrSh:Dropper-F [Trj]", "method": "blacklist", "engine_update": "20230418"}, "Panda": {"category": "undetected", "engine_name": "Panda", "engine_version": "4.6.4.2", "result": null, "method": "blacklist", "engine_update": "20230418"}, "CrowdStrike": {"category": "type-unsupported", "engine_name": "CrowdStrike", "engine_version": "1.0", "result": null, "method": "blacklist", "engine_update": null}}, "reputation": 0, "sigma_analysis_stats": {"high": 1, "medium": 1, "critical": 0, "low": 0}, "crowdsourced_ai_results": [{"category": "code_insight", "source": "palm", "id": "5d7ba2b775cdd1c1b2f4f468e2f06bf0f16d9738b433cd31d406608e537ca927-file-palm", "analysis": "This code is a PowerShell script that defines two functions: `func_get_proc_address` and `func_get_delegate_type`. The first function takes a module and a procedure name as input and returns the address of the procedure in memory. The second function takes a delegate type and a return type as input and returns a delegate that can be used to invoke the delegate.\r\n\r\nThe code is likely malicious because it provides functionality that could be used to bypass security controls. For example, the `func_get_proc_address` function could be used to obtain the address of a protected procedure and then use that address to invoke the procedure without having to go through the normal security checks. The `func_get_delegate_type` function could be used to create a delegate that can be used to invoke a delegate without having to specify the delegate type. This could be used to create a delegate that can be used to invoke a malicious delegate."}]}, "type": "file", "id": "5d7ba2b775cdd1c1b2f4f468e2f06bf0f16d9738b433cd31d406608e537ca927", "links": {"self": "https://www.virustotal.com/api/v3/files/5d7ba2b775cdd1c1b2f4f468e2f06bf0f16d9738b433cd31d406608e537ca927"}}}